<div class="padded" style="align-items: center;">
  <mat-form-field style="width: 500px">
    <mat-select [(value)]="selectedOption" >
      <mat-option [value]="-1">ყველა პროდუქტი და მომსახურება</mat-option>
      <mat-option *ngFor="let product of (checked ? userBonuses : userSales); let i = index" [value]="i">
        {{product?.product.name}}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <mat-slide-toggle
    [checked]="checked"
    (change)="onSlideChange()">{{!checked ? 'რაოდენობა' : 'თანხა' }}
  </mat-slide-toggle>
</div>
<mat-divider></mat-divider>
<mat-grid-list [cols]="selectedOption > -1 ? 5 : 3" rowHeight="130px">
  <mat-grid-tile>
    <mat-card>
      <mat-card-header>
        <mat-card-title>{{checked ? 'ჩემი თანხა' : 'ჩემი ოპერაციები' }}</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p class="card-number" *ngIf="!checked">{{user?.userStaffLevel === 'MIDDLE_MANAGER' ? branchTotalOperations?.currentBranchSales.toLocaleString() : selectedOption > -1 ? userSales[selectedOption].userResult.toLocaleString() : salesTotalQuantityPrimary?.toLocaleString()}}</p>
        <p class="card-number" *ngIf="checked">{{user?.userStaffLevel === 'MIDDLE_MANAGER' ? branchTotalOperations?.currentBranchSales.toLocaleString() : selectedOption > -1 ? (userBonuses[selectedOption].userResult/100).toLocaleString()+' ლ' : (myBonusInGel/100)?.toLocaleString()+' ლ'}}</p>
      </mat-card-content>
    </mat-card>
  </mat-grid-tile>
  <mat-grid-tile>
    <mat-card>
      <mat-card-header>
        <mat-card-title>ბანკის საშუალო</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p class="card-number" *ngIf="!checked">{{user?.userStaffLevel === 'MIDDLE_MANAGER' ? branchTotalOperations?.branchesMean : selectedOption > -1 ? userSales[selectedOption].bankAverage : bankStatistics?.saleRatingDto.mean.toLocaleString()}}</p>
        <p class="card-number" *ngIf="checked">{{user?.userStaffLevel === 'MIDDLE_MANAGER' ? branchTotalOperations?.branchesMean : selectedOption > -1 ? (userBonuses[selectedOption].bankAverage/100)+' ლ' : (bankStatistics?.bonusRatingDto.mean/100).toLocaleString()+' ლ'}}</p>
        <p class="rating__position" [matTooltip]="!checked ? 'თქვენი რეიტინგი ბანკში ოპერაციების მიხედვით' : 'თქვენი რეიტინგი ბანკში თანხის მიხედვით'">{{selectedOption === -1 && !checked ? bankStatistics?.saleRatingDto.rating  + ' |' : selectedOption === -1 && checked ? bankStatistics?.bonusRatingDto.rating  + ' |' : !checked ? userSales[selectedOption].bankrating + ' |' : userBonuses[selectedOption].bankrating + ' |'}}</p>
        <p class="rating__percentage" [matTooltip]="!checked ? 'თქვენი ოპერაციების შეფარდება ბანკის საშუალო ოპერაციებთან' : 'თქვენი თანხის შეფარდება ბანკის საშუალო თანხასთან'">{{selectedOption === -1 && !checked ? (salesTotalQuantityPrimary/(bankStatistics?.saleRatingDto.mean/100)).toFixed(1) + '%' : selectedOption === -1 && checked ? (myBonusInGel/(bankStatistics?.bonusRatingDto.mean/100)).toFixed(1) + '%' : !checked ? (userSales[selectedOption].userResult/(userSales[selectedOption].bankAverage/100)).toFixed(1) + '%' : (userBonuses[selectedOption].userResult/(userBonuses[selectedOption].bankAverage/100)).toFixed(1) + '%'}}</p>
      </mat-card-content>
    </mat-card>
  </mat-grid-tile>
  <mat-grid-tile>
    <mat-card>
      <mat-card-header>
        <mat-card-title>ბანკის მაქსიმუმი</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p class="card-number" *ngIf="!checked">{{user?.userStaffLevel === 'MIDDLE_MANAGER' ? branchTotalOperations?.branchesMax : selectedOption > -1 ? userSales[selectedOption].bankmax : bankStatistics?.saleRatingDto.maxPoints.toLocaleString()}}</p>
        <p class="card-number" *ngIf="checked">{{user?.userStaffLevel === 'MIDDLE_MANAGER' ? branchTotalOperations?.branchesMax : selectedOption > -1 ? (userBonuses[selectedOption].bankmax/100)+' ლ' : (bankStatistics?.bonusRatingDto.maxPoints/100).toLocaleString()+' ლ'}}</p>
        <p class="rating__position" [matTooltip]="!checked ? 'თქვენი რეიტინგი ბანკში ოპერაციების მიხედვით' : 'თქვენი რეიტინგი ბანკში თანხის მიხედვით'">{{selectedOption === -1 && !checked ? bankStatistics?.saleRatingDto.rating  + ' |' : selectedOption === -1 && checked ? bankStatistics?.bonusRatingDto.rating  + ' |' : !checked ? userSales[selectedOption].bankrating + ' |' : userBonuses[selectedOption].bankrating + ' |'}}</p>
        <p class="rating__percentage" [matTooltip]="!checked ? 'თქვენი ოპერაციების შეფარდება ბანკის მაქსიმალურ ოპერაციებთან' : 'თქვენი თანხის შეფარდება ბანკის მაქსიმალურ თანხასთან'">{{selectedOption === -1 && !checked ? (salesTotalQuantityPrimary/(bankStatistics?.saleRatingDto.maxPoints/100)).toFixed(1) + '%' : selectedOption === -1 && checked ? (myBonusInGel/(bankStatistics?.bonusRatingDto.maxPoints/100)).toFixed(1) + '%' : !checked ? (userSales[selectedOption].userResult/(userSales[selectedOption].bankmax/100)).toFixed(1) + '%' : (userBonuses[selectedOption].userResult/(userBonuses[selectedOption].bankmax/100)).toFixed(1) + '%'}}</p>
      </mat-card-content>
    </mat-card>
  </mat-grid-tile>
  <mat-grid-tile *ngIf="selectedOption > -1 && user?.userStaffLevel !== 'MIDDLE_MANAGER'">
    <mat-card>
      <mat-card-header>
        <mat-card-title>ჯგუფის საშუალო</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p class="card-number" *ngIf="!checked">{{userSales[selectedOption].groupAverage}}</p>
        <p class="card-number" *ngIf="checked">{{(userBonuses[selectedOption].groupAverage/100)+' ლ'}}</p>
        <p class="rating__position" [matTooltip]="!checked ? 'თქვენი რეიტინგი ჯგუფში ოპერაციების მიხედვით' : 'თქვენი რეიტინგი ჯგუფში თანხის მიხედვით'" *ngIf="selectedOption > -1">{{!checked ? userSales[selectedOption].groupRating + ' |' : userBonuses[selectedOption].groupRating + ' |'}}</p>
        <p class="rating__percentage" [matTooltip]="!checked ? 'თქვენი ოპერაციების შეფარდება ჯგუფის საშუალო ოპერაციებთან' : 'თქვენი თანხის შეფარდება ჯგუფის საშუალო თანხასთან'" *ngIf="selectedOption > -1">{{!checked ? (userSales[selectedOption].userResult/(userSales[selectedOption].groupAverage/100)).toFixed(1) + '%' : (userBonuses[selectedOption].userResult/(userBonuses[selectedOption].groupAverage/100)).toFixed(1) + '%'}}</p>
      </mat-card-content>
    </mat-card>
  </mat-grid-tile>
  <mat-grid-tile *ngIf="selectedOption > -1 && user?.userStaffLevel !== 'MIDDLE_MANAGER'">
    <mat-card>
      <mat-card-header>
        <mat-card-title>ჯგუფის მაქსიმუმი</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p class="card-number" *ngIf="!checked">{{userSales[selectedOption].groupMax.toLocaleString()}}</p>
        <p class="card-number" *ngIf="checked">{{(userBonuses[selectedOption].groupMax/100).toLocaleString()+' ლ'}}</p>
        <p class="rating__position" [matTooltip]="!checked ? 'თქვენი რეიტინგი ჯგუფში ოპერაციების მიხედვით' : 'თქვენი რეიტინგი ჯგუფში თანხის მიხედვით'" *ngIf="selectedOption > -1">{{!checked ? userSales[selectedOption].groupRating + ' |' : userBonuses[selectedOption].groupRating + ' |'}}</p>
        <p class="rating__percentage" [matTooltip]="!checked ? 'თქვენი ოპერაციების შეფარდება ჯგუფის მაქსიმალურ ოპერაციებთან' : 'თქვენი თანხის შეფარდება ჯგუფის მაქსიმალურ თანხასთან'" *ngIf="selectedOption > -1">{{!checked ? (userSales[selectedOption].userResult/(userSales[selectedOption].groupMax/100)).toFixed(1) + '%' : (userBonuses[selectedOption].userResult/(userBonuses [selectedOption].groupMax/100)).toFixed(1) + '%'}}</p>
      </mat-card-content>
    </mat-card>
  </mat-grid-tile>
</mat-grid-list>
<div class="scrolled-container-center">
  <mat-expansion-panel>
    <mat-expansion-panel-header>
      <mat-panel-title>
        ძირითადი პროდუქტი
      </mat-panel-title>
      <mat-panel-description>
        {{checked ?  'ლარი: ' + (bonusTotalQuantityPrimary/100)?.toLocaleString() : 'ოპერაცია: ' + salesTotalQuantityPrimary?.toLocaleString() }}
      </mat-panel-description>
    </mat-expansion-panel-header>
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          მოზიდვა
        </mat-panel-title>
        <mat-panel-description>

        </mat-panel-description>
      </mat-expansion-panel-header>
      <ng-container *ngFor="let data of (!checked ? userSales : userBonuses)">
        <div class="progress-bar__container"
             *ngIf="data.product.primary && data.product.productMotivationalBlockType === 'ACQUISITION'">
          <div class="progress-bar__labels">
            <div class="progress-bar__labels-left" routerLink="/product">
              {{data.product.name}}
            </div>
          </div>
          <div *ngIf="!checked" class="triangle-up" style="border-top: 10px solid red"
               [ngStyle]="{left: (data.competenceLevel.productMinSales/data.bankmax * 100) + '%', display: data.competenceLevel.productMinSales === 0 ? 'none' : ''}"
               [matTooltip]="'მინიმალური ზღვარი ' + data.competenceLevel.productMinSales"
               matTooltipPosition="above"></div>
          <mat-icon class="triangle"
               [ngStyle]="{left: (data.userResult/data.bankmax * 100) > 95 ? '95%' : (data.userResult/data.bankmax * 100) + '%', color: !checked ? data.competenceLevel.productMinSales <= data.userResult ? 'green' : 'red' : 'green'}"
               [matTooltip]="!checked ? 'ჩემი შედეგი ' + data.userResult : 'ჩემი შედეგი ' + data.userResult/100 + 'ლ'"
               matTooltipPosition="above">{{!checked ? data.competenceLevel.productMinSales > data.userResult ? 'sentiment_very_dissatisfied' : 'sentiment_satisfied' : 'sentiment_satisfied'}}</mat-icon>
          <mat-icon class="triangle-down" style="color: blue"
               [ngStyle]="{left: (data.groupAverage/data.bankmax * 100) > 95 ? '95%' : (data.groupAverage/data.bankmax * 100) + '%'}"
               [matTooltip]="!checked ? 'ჯგუფის საშუალო ' + data.groupAverage : 'ჯგუფის საშუალო ' + data.groupAverage/100 + 'ლ'"
               matTooltipPosition="above">group</mat-icon>
          <img src="../../images/groupMax.png" class="triangle"
               [ngStyle]="{left: (data.groupMax/data.bankmax * 100) > 95 ? '95%' : (data.groupMax/data.bankmax * 100) + '%'}"
               [matTooltip]="!checked ? 'ჯგუფის მაქსიმუმი ' + data.groupMax : 'ჯგუფის მაქსიმუმი ' + data.groupMax/100 + 'ლ'"
               matTooltipPosition="above">
          <i class="fa fa-users triangle-down" style="color: #f067ff; top:8px; font-size: 0.9rem"
               [ngStyle]="{left: (data.bankAverage/data.bankmax * 100) > 95 ? '95%' : (data.bankAverage/data.bankmax * 100) + '%'}"
               [matTooltip]="!checked ? 'ბანკის საშუალო ' + data.bankAverage : 'ბანკის საშუალო ' + data.bankAverage/100 + 'ლ'"
               matTooltipPosition="above"></i>
          <img src="../../images/bankMax.png" class="triangle-down"  [ngStyle]="{left: '95%'}"
               [matTooltip]="!checked ? 'ბანკის მაქსიმუმი ' + data.bankmax : 'ბანკის მაქსიმუმი ' + data.bankmax/100 + 'ლ'"
               matTooltipPosition="above">
          <div class="progress-bar__level1" [ngStyle]="{ backgroundColor: !checked ? data.competenceLevel.productMinSales <= data.userResult ? 'green' : 'red' : 'green' }">
          </div>
        </div>

      </ng-container>
    </mat-expansion-panel>
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          დაკრედიტება
        </mat-panel-title>
        <mat-panel-description>

        </mat-panel-description>
      </mat-expansion-panel-header>
      <ng-container *ngFor="let data of (!checked ? userSales : userBonuses)">
        <div class="progress-bar__container"
             *ngIf="data.product.primary && data.product.productMotivationalBlockType === 'CREDIT_ISSUANCE'">
          <div class="progress-bar__labels">
            <div class="progress-bar__labels-left" routerLink="/product">
              {{data.product.name}}
            </div>
          </div>
          <div *ngIf="!checked" class="triangle-up" style="border-top: 10px solid red"
               [ngStyle]="{left: (data.competenceLevel.productMinSales/data.bankmax * 100) + '%', display: data.competenceLevel.productMinSales === 0 ? 'none' : ''}"
               [matTooltip]="'მინიმალური ზღვარი ' + data.competenceLevel.productMinSales"
               matTooltipPosition="above"></div>
          <mat-icon class="triangle"
                    [ngStyle]="{left: (data.userResult/data.bankmax * 100) > 95 ? '95%' : (data.userResult/data.bankmax * 100) + '%', color: !checked ? data.competenceLevel.productMinSales <= data.userResult ? 'green' : 'red' : 'green'}"
                    [matTooltip]="!checked ? 'ჩემი შედეგი ' + data.userResult : 'ჩემი შედეგი ' + data.userResult/100 + 'ლ'"
                    matTooltipPosition="above">{{!checked ? data.competenceLevel.productMinSales > data.userResult ? 'sentiment_very_dissatisfied' : 'sentiment_satisfied' : 'sentiment_satisfied'}}</mat-icon>
          <mat-icon class="triangle-down" style="color: blue"
                    [ngStyle]="{left: (data.groupAverage/data.bankmax * 100) > 95 ? '95%' : (data.groupAverage/data.bankmax * 100) + '%'}"
                    [matTooltip]="!checked ? 'ჯგუფის საშუალო ' + data.groupAverage : 'ჯგუფის საშუალო ' + data.groupAverage/100 + 'ლ'"
                    matTooltipPosition="above">group</mat-icon>
          <img src="../../images/groupMax.png" class="triangle"
               [ngStyle]="{left: (data.groupMax/data.bankmax * 100) > 95 ? '95%' : (data.groupMax/data.bankmax * 100) + '%'}"
               [matTooltip]="!checked ? 'ჯგუფის მაქსიმუმი ' + data.groupMax : 'ჯგუფის მაქსიმუმი ' + data.groupMax/100 + 'ლ'"
               matTooltipPosition="above">
          <i class="fa fa-users triangle-down" style="color: #f067ff; top:8px; font-size: 0.9rem"
             [ngStyle]="{left: (data.bankAverage/data.bankmax * 100) > 95 ? '95%' : (data.bankAverage/data.bankmax * 100) + '%'}"
             [matTooltip]="!checked ? 'ბანკის საშუალო ' + data.bankAverage : 'ბანკის საშუალო ' + data.bankAverage/100 + 'ლ'"
             matTooltipPosition="above"></i>
          <img src="../../images/bankMax.png" class="triangle-down"  [ngStyle]="{left: '95%'}"
               [matTooltip]="!checked ? 'ბანკის მაქსიმუმი ' + data.bankmax : 'ბანკის მაქსიმუმი ' + data.bankmax/100 + 'ლ'"
               matTooltipPosition="above">
          <div class="progress-bar__level1" [ngStyle]="{ backgroundColor: !checked ? data.competenceLevel.productMinSales <= data.userResult ? 'green' : 'red' : 'green' }">
          </div>
        </div>

      </ng-container>
    </mat-expansion-panel>
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          მომსახურება
        </mat-panel-title>
        <mat-panel-description>

        </mat-panel-description>
      </mat-expansion-panel-header>
      <ng-container *ngFor="let data of (!checked ? userSales : userBonuses)">
        <div class="progress-bar__container"
             *ngIf="data.product.primary && data.product.productMotivationalBlockType === 'SERVICE'">
          <div class="progress-bar__labels">
            <div class="progress-bar__labels-left" routerLink="/product">
              {{data.product.name}}
            </div>
          </div>
          <div *ngIf="!checked" class="triangle-up" style="border-top: 10px solid red"
               [ngStyle]="{left: (data.competenceLevel.productMinSales/data.bankmax * 100) + '%', display: data.competenceLevel.productMinSales === 0 ? 'none' : ''}"
               [matTooltip]="'მინიმალური ზღვარი ' + data.competenceLevel.productMinSales"
               matTooltipPosition="above"></div>
          <mat-icon class="triangle"
                    [ngStyle]="{left: (data.userResult/data.bankmax * 100) > 95 ? '95%' : (data.userResult/data.bankmax * 100) + '%', color: !checked ? data.competenceLevel.productMinSales <= data.userResult ? 'green' : 'red' : 'green'}"
                    [matTooltip]="!checked ? 'ჩემი შედეგი ' + data.userResult : 'ჩემი შედეგი ' + data.userResult/100 + 'ლ'"
                    matTooltipPosition="above">{{!checked ? data.competenceLevel.productMinSales > data.userResult ? 'sentiment_very_dissatisfied' : 'sentiment_satisfied' : 'sentiment_satisfied'}}</mat-icon>
          <mat-icon class="triangle-down" style="color: blue"
                    [ngStyle]="{left: (data.groupAverage/data.bankmax * 100) > 95 ? '95%' : (data.groupAverage/data.bankmax * 100) + '%'}"
                    [matTooltip]="!checked ? 'ჯგუფის საშუალო ' + data.groupAverage : 'ჯგუფის საშუალო ' + data.groupAverage/100 + 'ლ'"
                    matTooltipPosition="above">group</mat-icon>
          <img src="../../images/groupMax.png" class="triangle"
               [ngStyle]="{left: (data.groupMax/data.bankmax * 100) > 95 ? '95%' : (data.groupMax/data.bankmax * 100) + '%'}"
               [matTooltip]="!checked ? 'ჯგუფის მაქსიმუმი ' + data.groupMax : 'ჯგუფის მაქსიმუმი ' + data.groupMax/100 + 'ლ'"
               matTooltipPosition="above">
          <i class="fa fa-users triangle-down" style="color: #f067ff; top:8px; font-size: 0.9rem"
             [ngStyle]="{left: (data.bankAverage/data.bankmax * 100) > 95 ? '95%' : (data.bankAverage/data.bankmax * 100) + '%'}"
             [matTooltip]="!checked ? 'ბანკის საშუალო ' + data.bankAverage : 'ბანკის საშუალო ' + data.bankAverage/100 + 'ლ'"
             matTooltipPosition="above"></i>
          <img src="../../images/bankMax.png" class="triangle-down"  [ngStyle]="{left: '95%'}"
               [matTooltip]="!checked ? 'ბანკის მაქსიმუმი ' + data.bankmax : 'ბანკის მაქსიმუმი ' + data.bankmax/100 + 'ლ'"
               matTooltipPosition="above">
          <div class="progress-bar__level1" [ngStyle]="{ backgroundColor: !checked ? data.competenceLevel.productMinSales <= data.userResult ? 'green' : 'red' : 'green' }">
          </div>
        </div>

      </ng-container>
    </mat-expansion-panel>
  </mat-expansion-panel>
  <mat-expansion-panel>
    <mat-expansion-panel-header>
      <mat-panel-title>
        სხვა პროდუქტი
      </mat-panel-title>
      <mat-panel-description>
        {{checked ? 'ლარი: '+(bonusTotalQuantityOther/100)?.toLocaleString()  :  'ოპერაცია: ' + salesTotalQuantityOther?.toLocaleString() }}
      </mat-panel-description>
    </mat-expansion-panel-header>
    <ng-container *ngFor="let data of (!checked ? userSales : userBonuses)">
      <div class="progress-bar__container"
           *ngIf="!data.product.primary">
        <div class="progress-bar__labels">
          <div class="progress-bar__labels-left" routerLink="/product">
            {{data.product.name}}
          </div>
        </div>
        <div *ngIf="!checked" class="triangle-up" style="border-top: 10px solid red"
             [ngStyle]="{left: (data.competenceLevel.productMinSales/data.bankmax * 100) + '%', display: data.competenceLevel.productMinSales === 0 ? 'none' : ''}"
             [matTooltip]="'მინიმალური ზღვარი ' + data.competenceLevel.productMinSales"
             matTooltipPosition="above"></div>
        <mat-icon class="triangle"
                  [ngStyle]="{left: (data.userResult/data.bankmax * 100) > 95 ? '95%' : (data.userResult/data.bankmax * 100) + '%', color: !checked ? data.competenceLevel.productMinSales <= data.userResult ? 'green' : 'red' : 'green'}"
                  [matTooltip]="!checked ? 'ჩემი შედეგი ' + data.userResult : 'ჩემი შედეგი ' + data.userResult/100 + 'ლ'"
                  matTooltipPosition="above">{{!checked ? data.competenceLevel.productMinSales > data.userResult ? 'sentiment_very_dissatisfied' : 'sentiment_satisfied' : 'sentiment_satisfied'}}</mat-icon>
        <mat-icon class="triangle-down" style="color: blue"
                  [ngStyle]="{left: (data.groupAverage/data.bankmax * 100) > 95 ? '95%' : (data.groupAverage/data.bankmax * 100) + '%'}"
                  [matTooltip]="!checked ? 'ჯგუფის საშუალო ' + data.groupAverage : 'ჯგუფის საშუალო ' + data.groupAverage/100 + 'ლ'"
                  matTooltipPosition="above">group</mat-icon>
        <img src="../../images/groupMax.png" class="triangle"
             [ngStyle]="{left: (data.groupMax/data.bankmax * 100) > 95 ? '95%' : (data.groupMax/data.bankmax * 100) + '%'}"
             [matTooltip]="!checked ? 'ჯგუფის მაქსიმუმი ' + data.groupMax : 'ჯგუფის მაქსიმუმი ' + data.groupMax/100 + 'ლ'"
             matTooltipPosition="above">
        <i class="fa fa-users triangle-down" style="color: #f067ff; top:8px; font-size: 0.9rem"
           [ngStyle]="{left: (data.bankAverage/data.bankmax * 100) > 95 ? '95%' : (data.bankAverage/data.bankmax * 100) + '%'}"
           [matTooltip]="!checked ? 'ბანკის საშუალო ' + data.bankAverage : 'ბანკის საშუალო ' + data.bankAverage/100 + 'ლ'"
           matTooltipPosition="above"></i>
        <img src="../../images/bankMax.png" class="triangle-down"  [ngStyle]="{left: '95%'}"
             [matTooltip]="!checked ? 'ბანკის მაქსიმუმი ' + data.bankmax : 'ბანკის მაქსიმუმი ' + data.bankmax/100 + 'ლ'"
             matTooltipPosition="above">
        <div class="progress-bar__level1" [ngStyle]="{ backgroundColor: !checked ? data.competenceLevel.productMinSales <= data.userResult ? 'green' : 'red' : 'green' }">
        </div>
      </div>

    </ng-container>
  </mat-expansion-panel>

  <!--Line Chart Start-->

  <div class="title-header">
    <h5 class="text-left">
      გრაფიკული ანალიზი
    </h5>
  </div>

  <mat-tab-group
    [selectedIndex]="selectedTab.value"
    (selectedIndexChange)="loadLineChartData(selected.value, ($event + 1) * 3)">
    <mat-tab label="წინა 3 თვე">
      <div class="padded" *ngIf="isDataAvailable && lineChartDataAvailable" style="padding: 0; margin-top: 30px">

        <canvas baseChart
                [datasets]="lineChartData"
                [labels]="lineChartLabels"
                [options]="lineChartOptions"
                [colors]="lineChartColors"
                [legend]="lineChartLegend"
                [chartType]="lineChartType"></canvas>

        <mat-form-field>
          <mat-select placeholder="აირჩიეთ პროდუქტი" [(value)]="selected.value"
                      (selectionChange)="loadLineChartData(selected.value, 3)">
            <mat-option *ngFor="let product of lineChartArray.prorductsBonusesByMonths; let i = index" [value]="i ">{{product.product.name}}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </mat-tab>
    <mat-tab label="წინა 6 თვე">
      <div class="padded" *ngIf="isDataAvailable && lineChartDataAvailable" style="padding: 0; margin-top: 30px">

        <canvas baseChart
                [datasets]="lineChartData"
                [labels]="lineChartLabels"
                [options]="lineChartOptions"
                [colors]="lineChartColors"
                [legend]="lineChartLegend"
                [chartType]="lineChartType"></canvas>

        <mat-form-field>
          <mat-select placeholder="აირჩიეთ პროდუქტი" [(value)]="selected.value"
                      (selectionChange)="loadLineChartData(selected.value, 6)">
            <mat-option *ngFor="let product of lineChartArray.prorductsBonusesByMonths; let i = index" [value]="i ">{{product.product.name}}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </mat-tab>
    <mat-tab label="წინა 9 თვე">
      <div class="padded" *ngIf="isDataAvailable && lineChartDataAvailable" style="padding: 0; margin-top: 30px">

        <canvas baseChart
                [datasets]="lineChartData"
                [labels]="lineChartLabels"
                [options]="lineChartOptions"
                [colors]="lineChartColors"
                [legend]="lineChartLegend"
                [chartType]="lineChartType"></canvas>

        <mat-form-field>
          <mat-select placeholder="აირჩიეთ პროდუქტი" [(value)]="selected.value"
                      (selectionChange)="loadLineChartData(selected.value, 9)">
            <mat-option *ngFor="let product of lineChartArray.prorductsBonusesByMonths; let i = index" [value]="i ">{{product.product.name}}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </mat-tab>
    <mat-tab label="წინა 12 თვე">
      <div class="padded" *ngIf="isDataAvailable && lineChartDataAvailable" style="padding: 0; margin-top: 30px">

        <canvas baseChart
                [datasets]="lineChartData"
                [labels]="lineChartLabels"
                [options]="lineChartOptions"
                [colors]="lineChartColors"
                [legend]="lineChartLegend"
                [chartType]="lineChartType"></canvas>

        <mat-form-field>
          <mat-select placeholder="აირჩიეთ პროდუქტი" [(value)]="selected.value"
                      (selectionChange)="loadLineChartData(selected.value, 12)">
            <mat-option *ngFor="let product of lineChartArray.prorductsBonusesByMonths; let i = index" [value]="i ">{{product.product.name}}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </mat-tab>
  </mat-tab-group>


  <!--Line Chart End-->
</div>

<!--Doughnut Chart Start-->

<div class="fixed-container-right" *ngIf="isDataAvailable">
    <div class="profile__doughnut-chart">
      <div class="title-header">
        <h5 class="text-left">
          ჩემი ბონუსი
        </h5>
      </div>
      <canvas height="120" width="120" baseChart
              [data]="doughnutChartData"
              [labels]="doughnutChartLabels"
              [chartType]="doughnutChartType"
              [options]="doughnutOptions"
              [colors]="doughnutChartColors"></canvas>
      <div class="profile__doughnut-chart--legend">
        <label class="chart-legend" *ngFor="let data of combinedArray"><span class="kvadrawik"
                                                                             [ngStyle]="{ backgroundColor: data.color }"></span>{{data.label}}</label>
      </div>
      <div class="doughnut-chart__label">
        <strong>{{myBonusInGel/100}}</strong>
        <label>ლარი</label>
      </div>
      <div class="doughnut-chart__rating-data">
        <div class="doughnut-chart__rating-data--right-side">
          <p>{{'რეიტინგი ბანკში თანხის მიხედვით '+bankStatistics?.bonusRatingDto.rating}}</p>
          <p>{{'მაქსიმალური თანხა ბანკში ' +(bankStatistics?.bonusRatingDto.maxPoints/100)?.toLocaleString()+' ლ'}}</p>
        </div>
      </div>
    </div>

</div>

<!--Doughnut Chart End-->
